<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.chart.*?>
<?import java.lang.String?>

<BorderPane xmlns:fx="http://javafx.com/fxml" 
            fx:controller="main.controllers.OwnerController"
            prefWidth="960" prefHeight="540"
            style="-fx-background-color: linear-gradient(to bottom right, #667eea 0%, #764ba2 25%, #f093fb 50%, #4facfe 75%, #00f2fe 100%);">

    

    <top>
        <VBox spacing="0">
            <!-- Hero Header -->
            <HBox alignment="CENTER" style="-fx-padding: 25 30 25 30; -fx-background-color: rgba(0,0,0,0.2);">
                <VBox alignment="CENTER" spacing="5">
                    <Label text="ðŸ‘”" style="-fx-font-size: 48px;"/>
                    <Label text="GreenGrocer Owner" style="-fx-font-size: 32px; -fx-font-weight: 900; -fx-text-fill: white; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.4), 15, 0, 0, 5);"/>
                    <Label text="Business Management Dashboard" style="-fx-font-size: 14px; -fx-text-fill: rgba(255,255,255,0.9); -fx-font-weight: 600;"/>
                </VBox>
            </HBox>
            
            <!-- Navigation Bar -->
            <HBox alignment="CENTER" spacing="12" style="-fx-padding: 15 25; -fx-background-color: rgba(255,255,255,0.15); -fx-border-color: rgba(255,255,255,0.2); -fx-border-width: 1 0 0 0;">
                <Label text="Welcome Owner" style="-fx-text-fill: white; -fx-font-weight: 700; -fx-font-size: 14px;"/>
                <Region HBox.hgrow="ALWAYS" />
                <Button text="Logout" onAction="#handleLogout" styleClass="danger-button"/>
            </HBox>
        </VBox>
    </top>

    <center>
        <TabPane tabClosingPolicy="UNAVAILABLE" style="-fx-background-color: transparent; -fx-padding: 10;">
            
            <Tab text="ðŸ’° Products">  
                <VBox spacing="10" style="-fx-padding: 15;">
                    <!-- Header Card -->
                    <HBox alignment="CENTER" spacing="10" styleClass="glass-card" style="-fx-padding: 12;">
                        <Label text="ðŸ’°" style="-fx-font-size: 24px;"/>
                        <VBox alignment="CENTER_LEFT" spacing="2">
                            <Label text="Product Management" style="-fx-font-size: 16px; -fx-font-weight: 900; -fx-text-fill: #1E3A8A;"/>
                            <Label text="Manage inventory with dynamic pricing" style="-fx-font-size: 10px; -fx-text-fill: rgba(44,62,80,0.7); -fx-font-weight: 600;"/>
                        </VBox>
                    </HBox>
                    
                    <!-- Product Table -->
                    <VBox spacing="10" styleClass="glass-card" style="-fx-padding: 15;" VBox.vgrow="ALWAYS">
                        <Label text="ðŸ“¦ Current Products" style="-fx-font-size: 16px; -fx-font-weight: 900; -fx-text-fill: #1E3A8A;"/>
                        <TableView fx:id="productTable" styleClass="modern-table" VBox.vgrow="ALWAYS" prefHeight="400">
                            <columns>
                                <TableColumn fx:id="colName" text="Name" prefWidth="150"/>
                                <TableColumn fx:id="colCategory" text="Category" prefWidth="100"/>
                                <TableColumn fx:id="colPrice" text="Base Price" prefWidth="100"/>
                                <TableColumn fx:id="colStock" text="Stock" prefWidth="100"/>
                                <TableColumn fx:id="colThreshold" text="Threshold (Double Price)" prefWidth="150"/>
                            </columns>
                            <columnResizePolicy><TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/></columnResizePolicy>
                        </TableView>
                    </VBox>
                    
                    <!-- Add/Edit Product Form -->
                    <VBox spacing="12" styleClass="glass-card" style="-fx-padding: 15;">
                        <Label text="âž• Add/Update Product" style="-fx-font-size: 16px; -fx-font-weight: 900; -fx-text-fill: #1E3A8A;"/>
                        
                        <GridPane hgap="15" vgap="12">
                            <VBox spacing="6" GridPane.columnIndex="0" GridPane.rowIndex="0">
                                <Label text="Product Name" style="-fx-font-weight: 600; -fx-font-size: 13px; -fx-text-fill: #2C3E50;"/>
                                <TextField fx:id="nameField" promptText="Name" prefWidth="140" styleClass="input-field"/>
                            </VBox>
                            
                            <VBox spacing="6" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                <Label text="Category" style="-fx-font-weight: 600; -fx-font-size: 13px; -fx-text-fill: #2C3E50;"/>
                                <ComboBox fx:id="categoryBox" prefWidth="120" styleClass="combo-box"/>
                            </VBox>
                            
                            <VBox spacing="6" GridPane.columnIndex="2" GridPane.rowIndex="0">
                                <Label text="Price (TL)" style="-fx-font-weight: 600; -fx-font-size: 13px; -fx-text-fill: #2C3E50;"/>
                                <TextField fx:id="priceField" promptText="Price" prefWidth="100" styleClass="input-field"/>
                            </VBox>
                            
                            <VBox spacing="6" GridPane.columnIndex="3" GridPane.rowIndex="0">
                                <Label text="Stock (kg)" style="-fx-font-weight: 600; -fx-font-size: 13px; -fx-text-fill: #2C3E50;"/>
                                <TextField fx:id="stockField" promptText="Stock" prefWidth="100" styleClass="input-field"/>
                            </VBox>
                            
                            <VBox spacing="6" GridPane.columnIndex="4" GridPane.rowIndex="0">
                                <Label text="Threshold" style="-fx-font-weight: 600; -fx-font-size: 13px; -fx-text-fill: #2C3E50;"/>
                                <TextField fx:id="thresholdField" promptText="Threshold" prefWidth="100" styleClass="input-field"/>
                            </VBox>
                        </GridPane>
                        
                        <!-- Image and Action Buttons -->
                        <HBox spacing="15" alignment="CENTER_LEFT">
                            <VBox spacing="8">
                                <Button text="ðŸ“· Select Image" onAction="#handleSelectImage" styleClass="nav-button"/>
                                <Label fx:id="imagePathLabel" text="No image selected" style="-fx-font-size: 11px; -fx-text-fill: rgba(44,62,80,0.6);"/>
                            </VBox>
                            
                            <Region HBox.hgrow="ALWAYS"/>
                            
                            <Button text="âž• Add Product" onAction="#handleAddProduct" styleClass="primary-button"/>
                            <Button text="âœï¸ Update" onAction="#handleUpdateProduct" styleClass="nav-button"/>
                            <Button text="ðŸ—‘ï¸ Delete" onAction="#handleDeleteProduct" styleClass="danger-button"/>
                        </HBox>
                    </VBox>
                </VBox>
            </Tab>

            <Tab text="ðŸ›½ Carriers">
                <HBox spacing="25" style="-fx-padding: 20;" styleClass="glass-card">
                    <VBox spacing="10">
                        <Label text="ðŸ›½ Carrier List" style="-fx-font-size: 20px; -fx-font-weight: 900; -fx-text-fill: #1E3A8A;"/>
                        <ListView fx:id="carrierList" prefHeight="400"/>
                        <Button text="Fire Selected ðŸ”¥" onAction="#handleFireCarrier" maxWidth="Infinity">
                            <styleClass>
                                <String fx:value="danger-button" />
                            </styleClass>
                        </Button>
                        <Button text="Show Ratings â­" onAction="#handleShowRatings" maxWidth="Infinity" style="-fx-padding: 12; -fx-cursor: hand;">
                            <styleClass>
                                <String fx:value="nav-button" />
                            </styleClass>
                        </Button>
                    </VBox>
                    <VBox spacing="12" style="-fx-padding: 20; -fx-background-color: #F7FAF8; -fx-background-radius: 12;">
                        <styleClass>
                            <String fx:value="card" />
                        </styleClass>
                        <Label text="Employ New Carrier">
                            <styleClass>
                                <String fx:value="title-label" />
                            </styleClass>
                        </Label>
                        <TextField fx:id="newCarrierName" promptText="Username">
                            <styleClass>
                                <String fx:value="input-field" />
                            </styleClass>
                        </TextField>
                        <TextField fx:id="newCarrierPass" promptText="Password" style="-fx-padding: 10;">
                            <styleClass>
                                <String fx:value="input-field" />
                            </styleClass>
                        </TextField>
                        <Button text="Hire Carrier ðŸ¤" onAction="#handleHireCarrier" style="-fx-padding: 12; -fx-cursor: hand;">
                            <styleClass>
                                <String fx:value="primary-button" />
                            </styleClass>
                        </Button>
                    </VBox>
                </HBox>
            </Tab>

            <Tab text="Reports &amp; Analytics ðŸ“Š">
                <VBox spacing="15" style="-fx-padding: 20;">
                    <!-- Stats Cards -->
                    <HBox spacing="15" alignment="CENTER">
                        <!-- Total Revenue -->
                        <VBox alignment="CENTER" spacing="5" styleClass="glass-card" style="-fx-padding: 20; -fx-min-width: 200;">
                            <Label text="ðŸ’µ" style="-fx-font-size: 42px;"/>
                            <Label text="Total Revenue" style="-fx-font-size: 12px; -fx-text-fill: #1E3A8A; -fx-font-weight: 600; -fx-opacity: 0.7;"/>
                            <Label fx:id="totalRevenueLabel" text="0.00" style="-fx-font-size: 28px; -fx-font-weight: 900; -fx-text-fill: #10B981;"/>
                        </VBox>
                        
                        <!-- Completed Orders -->
                        <VBox alignment="CENTER" spacing="5" styleClass="glass-card" style="-fx-padding: 20; -fx-min-width: 200;">
                            <Label text="âœ“" style="-fx-font-size: 42px; -fx-font-weight: 900; -fx-text-fill: #10B981;"/>
                            <Label text="Completed Orders" style="-fx-font-size: 12px; -fx-text-fill: #1E3A8A; -fx-font-weight: 600; -fx-opacity: 0.7;"/>
                            <Label fx:id="completedOrdersLabel" text="0" style="-fx-font-size: 28px; -fx-font-weight: 900; -fx-text-fill: #3B82F6;"/>
                        </VBox>
                        
                        <!-- Pending Orders -->
                        <VBox alignment="CENTER" spacing="5" styleClass="glass-card" style="-fx-padding: 20; -fx-min-width: 200;">
                            <Label text="â±" style="-fx-font-size: 42px; -fx-font-weight: 900; -fx-text-fill: #F59E0B;"/>
                            <Label text="Pending Orders" style="-fx-font-size: 12px; -fx-text-fill: #1E3A8A; -fx-font-weight: 600; -fx-opacity: 0.7;"/>
                            <Label fx:id="pendingOrdersLabel" text="0" style="-fx-font-size: 28px; -fx-font-weight: 900; -fx-text-fill: #F59E0B;"/>
                        </VBox>
                        
                        <!-- Active Carriers -->
                        <VBox alignment="CENTER" spacing="5" styleClass="glass-card" style="-fx-padding: 20; -fx-min-width: 200;">
                            <Label text="ðŸšš" style="-fx-font-size: 42px;"/>
                            <Label text="Active Carriers" style="-fx-font-size: 12px; -fx-text-fill: #1E3A8A; -fx-font-weight: 600; -fx-opacity: 0.7;"/>
                            <Label fx:id="activeCarriersLabel" text="0" style="-fx-font-size: 28px; -fx-font-weight: 900; -fx-text-fill: #8B5CF6;"/>
                        </VBox>
                    </HBox>
                    
                    <!-- Best Carriers Section -->
                    <VBox spacing="10" styleClass="glass-card" style="-fx-padding: 20;">
                        <Label text="â˜… Top Rated Carriers" style="-fx-font-size: 18px; -fx-font-weight: 900; -fx-text-fill: #1E3A8A;"/>
                        <ListView fx:id="topCarriersListView" prefHeight="400" style="-fx-background-radius: 12;"/>
                    </VBox>
                    
                    <!-- Sales Chart -->
                    <VBox styleClass="glass-card" style="-fx-padding: 20;" VBox.vgrow="ALWAYS">
                        <BarChart fx:id="salesChart" title="Product Sales Overview" VBox.vgrow="ALWAYS">
                            <xAxis><CategoryAxis label="Product" fx:id="xAxis"/></xAxis>
                            <yAxis><NumberAxis label="Sold (kg)" fx:id="yAxis"/></yAxis>
                        </BarChart>
                    </VBox>
                </VBox>
            </Tab>

            <Tab text="ðŸ“¦ Orders &amp; Ratings">
                <VBox spacing="15" style="-fx-padding: 20;" styleClass="glass-card">
                    <!-- Header -->
                    <HBox alignment="CENTER" spacing="10" styleClass="glass-card" style="-fx-padding: 12;">
                        <Label text="ðŸ“¦" style="-fx-font-size: 24px;"/>
                        <VBox alignment="CENTER_LEFT" spacing="2">
                            <Label text="Order Management" style="-fx-font-size: 16px; -fx-font-weight: 900; -fx-text-fill: #1E3A8A;"/>
                            <Label text="View all orders and customer ratings" style="-fx-font-size: 10px; -fx-text-fill: rgba(44,62,80,0.7); -fx-font-weight: 600;"/>
                        </VBox>
                    </HBox>
                    
                    <!-- Orders Table -->
                    <VBox spacing="10" styleClass="glass-card" style="-fx-padding: 15;" VBox.vgrow="ALWAYS">
                        <Label text="ðŸ“‹ All Orders" style="-fx-font-size: 16px; -fx-font-weight: 900; -fx-text-fill: #1E3A8A;"/>
                        <TableView fx:id="ordersTable" styleClass="modern-table" VBox.vgrow="ALWAYS" prefHeight="450">
                            <columns>
                                <TableColumn fx:id="colOrderNum" text="Order #" prefWidth="80"/>
                                <TableColumn fx:id="colCustomer" text="Customer" prefWidth="100"/>
                                <TableColumn fx:id="colOrderDate" text="Date" prefWidth="150"/>
                                <TableColumn fx:id="colTotalPrice" text="Total" prefWidth="80"/>
                                <TableColumn fx:id="colOrderStatus" text="Status" prefWidth="100"/>
                                <TableColumn fx:id="colOrderCarrier" text="Carrier" prefWidth="100"/>
                                <TableColumn fx:id="colRating" text="Rating" prefWidth="100"/>
                                <TableColumn fx:id="colReview" text="Review" prefWidth="200"/>
                            </columns>
                            <columnResizePolicy><TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/></columnResizePolicy>
                        </TableView>
                        
                        <!-- Action Buttons -->
                        <HBox spacing="10" alignment="CENTER">
                            <Button text="ðŸ”„ Refresh Orders" onAction="#handleRefreshOrders" styleClass="nav-button" style="-fx-padding: 10 20;"/>
                            <Button text="â­ View Carrier Ratings" onAction="#handleViewAllRatings" styleClass="nav-button" style="-fx-padding: 10 20; -fx-background-color: rgba(252, 211, 77, 0.3);"/>
                        </HBox>
                    </VBox>
                </VBox>
            </Tab>

            <Tab text="Messages &amp; Settings âš™ï¸">
                <HBox spacing="20" style="-fx-padding: 20;">
                    <!-- Messages Section -->
                    <VBox spacing="15" HBox.hgrow="ALWAYS" styleClass="glass-card" style="-fx-padding: 20;">
                        <!-- Conversations List -->
                        <VBox spacing="8" style="-fx-padding: 10; -fx-background-color: #F8F9FA; -fx-background-radius: 12;" prefHeight="350">
                            <Label text="ðŸ“‹ Conversations" style="-fx-font-size: 14px; -fx-font-weight: 700; -fx-text-fill: #2C3E50;"/>
                            <ListView fx:id="messageList" style="-fx-background-color: transparent; -fx-background-radius: 8; -fx-border-color: #E0E0E0; -fx-border-radius: 8; -fx-border-width: 1;" prefHeight="300"/>
                        </VBox>
                        
                        <!-- Chat Area -->
                        <VBox spacing="12" VBox.vgrow="ALWAYS" style="-fx-padding: 15; -fx-background-color: #FFFFFF; -fx-background-radius: 12; -fx-border-color: #E0E0E0; -fx-border-width: 1; -fx-border-radius: 12;">
                            <HBox alignment="CENTER_LEFT" spacing="10" style="-fx-padding: 8; -fx-background-color: #F0F4F8; -fx-background-radius: 8;">
                                <Label text="ðŸ’­" style="-fx-font-size: 20px;"/>
                                <Label text="Message Thread" style="-fx-font-size: 14px; -fx-font-weight: 700; -fx-text-fill: #475569;"/>
                            </HBox>
                            
                            <!-- Message Display Area (ScrollPane for chat bubbles) -->
                            <ScrollPane fitToWidth="true" style="-fx-background-color: transparent; -fx-background: #FAFBFC; -fx-border-color: #E5E7EB; -fx-border-width: 1; -fx-border-radius: 8;" VBox.vgrow="ALWAYS" prefHeight="250">
                                <VBox fx:id="chatMessagesBox" spacing="8" style="-fx-padding: 15; -fx-background-color: #FAFBFC;"/>
                            </ScrollPane>
                            
                            <!-- Reply Input Area -->
                            <VBox spacing="8">
                                <TextArea fx:id="replyField" promptText="Type your message here..." wrapText="true" prefRowCount="3" style="-fx-background-color: #F8FAFC; -fx-border-color: #CBD5E1; -fx-border-width: 2; -fx-border-radius: 12; -fx-background-radius: 12; -fx-padding: 12; -fx-font-size: 13px;"/>
                                <HBox spacing="10" alignment="CENTER_RIGHT">
                                    <Button text="Open Thread" onAction="#handleOpenThread" style="-fx-background-color: #E2E8F0; -fx-text-fill: #475569; -fx-font-weight: 700; -fx-background-radius: 10; -fx-padding: 10 20; -fx-cursor: hand;"/>
                                    <Button text="ðŸ“¤ Send Message" onAction="#handleReply" style="-fx-background-color: linear-gradient(to right, #667eea 0%, #764ba2 100%); -fx-text-fill: white; -fx-font-weight: 700; -fx-background-radius: 10; -fx-padding: 12 24; -fx-cursor: hand; -fx-effect: dropshadow(gaussian, rgba(102, 126, 234, 0.4), 8, 0, 0, 4);"/>
                                </HBox>
                            </VBox>
                        </VBox>
                    </VBox>
                    
                    <!-- Settings Sidebar -->
                    <VBox spacing="15" minWidth="240" styleClass="glass-card" style="-fx-padding: 20;">
                        <HBox alignment="CENTER_LEFT" spacing="10" style="-fx-padding: 8; -fx-background-color: linear-gradient(to right, #10B981 0%, #14B8A6 100%); -fx-background-radius: 10;">
                            <Label text="âš™ï¸" style="-fx-font-size: 20px;"/>
                            <Label text="Settings" style="-fx-font-size: 16px; -fx-font-weight: 900; -fx-text-fill: white;"/>
                        </HBox>
                        
                        <VBox spacing="10" style="-fx-padding: 12; -fx-background-color: #F7FAF8; -fx-background-radius: 12;">
                            <Label text="Loyalty Discount" style="-fx-font-weight: 700; -fx-text-fill: #2C3E50; -fx-font-size: 13px;"/>
                            <HBox spacing="8" alignment="CENTER_LEFT">
                                <TextField fx:id="loyaltyField" promptText="10" prefWidth="80" style="-fx-background-radius: 8; -fx-padding: 8;"/>
                                <Label text="percent" style="-fx-font-size: 16px; -fx-font-weight: 700; -fx-text-fill: #64748B;"/>
                            </HBox>
                            <Button text="âœ“ Update" onAction="#handleUpdateSettings" maxWidth="Infinity" style="-fx-background-color: #10B981; -fx-text-fill: white; -fx-font-weight: 700; -fx-background-radius: 8; -fx-padding: 10; -fx-cursor: hand;"/>
                        </VBox>
                        
                        <VBox spacing="8">
                            <Label text="ðŸŽŸï¸ Coupon Management" style="-fx-font-weight: 700; -fx-text-fill: #2C3E50; -fx-font-size: 13px;"/>
                            <Button text="View Coupons" onAction="#handleManageCoupons" maxWidth="Infinity" styleClass="nav-button" style="-fx-padding: 10; -fx-background-radius: 8;"/>
                            <Button text="+ Create New" onAction="#handleCreateCoupon" maxWidth="Infinity" style="-fx-background-color: #F59E0B; -fx-text-fill: white; -fx-font-weight: 700; -fx-background-radius: 8; -fx-padding: 10; -fx-cursor: hand;"/>
                        </VBox>
                        
                    </VBox>
                </HBox>
            </Tab>

        </TabPane>
    </center>

</BorderPane>